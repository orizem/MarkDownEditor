<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdnjs.cloudflare.com; style-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; connect-src 'self'; img-src 'self' data:; font-src 'self';" />
    <title>Markdown Editor</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
      id="hljs-theme"
    />
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/variables.css" />
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/titlebar.css" />
    <link rel="stylesheet" href="css/scrollbar.css" />
    <link rel="stylesheet" href="css/toolbar.css" />
    <link rel="stylesheet" href="css/tabs.css" />
    <link rel="stylesheet" href="css/layout.css" />
    <link rel="stylesheet" href="css/editor.css" />
    <link rel="stylesheet" href="css/preview.css" />
    <link rel="stylesheet" href="css/modals.css" />
    <style id="theme-styles">
      /* Dynamic theme styles will be applied here */
    </style>
  </head>
  <body>
    <!-- Custom Title Bar with Logo -->
    <div class="title-bar">
      <div class="title-bar-content">
        <div class="title-bar-left">
          <div class="app-logo">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <!-- Markdown logo/text icon -->
              <path d="M22.27 19.385H1.73A1.73 1.73 0 0 1 0 17.655V6.345a1.73 1.73 0 0 1 1.73-1.73h20.54A1.73 1.73 0 0 1 24 6.345v11.31a1.73 1.73 0 0 1-1.73 1.73zM5.769 15.923v-4.5l2.308 2.885 2.307-2.885v4.5h2.31V8.077h-2.31l-2.307 2.885L5.77 8.077H3.46v7.846zM21.232 12h-2.309V8.077H16.62V12h-2.309l2.31 2.885L21.231 12z"/>
            </svg>
          </div>
          <div class="title-bar-menu">
            <div class="menu-item" id="fileMenu">
              File
              <div class="dropdown-menu" id="fileDropdown">
                <div class="menu-option" data-action="new">New (Ctrl+N)</div>
                <div class="menu-option" data-action="open">Open (Ctrl+O)</div>
                <div class="menu-separator"></div>
                <div class="menu-option" data-action="save">Save (Ctrl+S)</div>
                <div class="menu-option" data-action="save-as">Save As (Ctrl+Shift+S)</div>
                <div class="menu-separator"></div>
                <div class="menu-option submenu-parent" id="exportSubmenu">
                  Export
                  <span class="submenu-arrow">›</span>
                  <div class="dropdown-menu submenu" id="exportSubmenuDropdown">
                    <div class="menu-option" data-action="export-md">Export as Markdown (.md)</div>
                    <div class="menu-option" data-action="export-pdf">Export as PDF</div>
                    <div class="menu-option" data-action="export-html">Export as HTML</div>
                  </div>
                </div>
                <div class="menu-separator"></div>
                <div class="menu-option" data-action="exit">Exit (Ctrl+Q)</div>
              </div>
            </div>
            <div class="menu-item" id="editMenu">
              Edit
              <div class="dropdown-menu" id="editDropdown">
                <div class="menu-option" data-action="cut">Cut (Ctrl+X)</div>
                <div class="menu-option" data-action="copy">Copy (Ctrl+C)</div>
                <div class="menu-option" data-action="paste">Paste (Ctrl+V)</div>
              </div>
            </div>
            <div class="menu-item" id="viewMenu">
              View
              <div class="dropdown-menu" id="viewDropdown">
                <div class="menu-option" data-action="toggle-outline">Toggle Outline (Ctrl+Q)</div>
                <div class="menu-option" data-action="toggle-editor">Toggle Editor (Ctrl+E)</div>
                <div class="menu-option" data-action="toggle-preview">Toggle Preview (Ctrl+P)</div>
                <div class="menu-separator"></div>
                <div class="menu-option" data-action="reload">Reload (Ctrl+R)</div>
                <div class="menu-option" data-action="devtools">Toggle DevTools (F12)</div>
              </div>
            </div>
          </div>
          <span id="appTitle">Markdown Editor</span>
        </div>
        <div class="window-controls">
          <button class="window-control minimize" id="minimizeBtn" title="Minimize">
            <svg width="10" height="10" viewBox="0 0 10 10">
              <path d="M0,5 L10,5" stroke="currentColor" stroke-width="1"/>
            </svg>
          </button>
          <button class="window-control maximize" id="maximizeBtn" title="Maximize">
            <svg width="10" height="10" viewBox="0 0 10 10">
              <path d="M0,0 L10,0 L10,10 L0,10 Z" stroke="currentColor" stroke-width="1" fill="none"/>
            </svg>
          </button>
          <button class="window-control close" id="closeBtn" title="Close">
            <svg width="10" height="10" viewBox="0 0 10 10">
              <path d="M0,0 L10,10 M10,0 L0,10" stroke="currentColor" stroke-width="1"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <div class="toolbar">
      <div class="toolbar-group">
        <button id="toggleOutline" class="active">Outline</button>
        <button id="toggleEditor" class="active">Editor</button>
        <button id="togglePreview" class="active">Preview</button>
      </div>


      <div class="toolbar-separator"></div>

      <div class="toolbar-group">
        <select id="themeSelect">
          <option value="dark">Dark Theme</option>
          <option value="light">Light Theme</option>
          <option value="monokai">Monokai</option>
          <option value="dracula">Dracula</option>
          <option value="nord">Nord</option>
          <option value="solarized-dark">Solarized Dark</option>
          <option value="solarized-light">Solarized Light</option>
          <option value="github">GitHub</option>
          <option value="custom">Custom Theme...</option>
        </select>

        <label>
          <input type="checkbox" id="syncScroll" checked />
          Sync Scroll
        </label>
        
        <label>
          <input type="checkbox" id="autoSaveToggle" checked />
          Auto-save
        </label>
      </div>
    </div>

    <!-- Tab Bar -->
    <div class="tab-bar" id="tabBar">
      <div class="tab-scroll-wrapper">
        <button class="tab-scroll-btn" id="scrollLeftBtn" title="Scroll Left">‹</button>
        <div class="tab-container" id="tabContainer">
          <!-- Tabs will be dynamically added here -->
        </div>
        <button class="tab-scroll-btn" id="scrollRightBtn" title="Scroll Right">›</button>
      </div>
      <button class="new-tab-btn" id="newTabBtn" title="New Tab (Ctrl+T)">+</button>
    </div>

    <div class="container">
      <div class="outline-panel" id="outlinePanel">
        <div class="panel-header">
          Outline
          <button class="outline-toggle" id="outlineToggle">×</button>
        </div>
        <div id="outline" class="outline-content"></div>
        <div class="resize-handle outline-resize-handle" id="outlineResizeHandle"></div>
      </div>

      <div class="editor-panel" id="editorPanel">
        <div class="panel-header">
          Editor
          <button class="outline-toggle" id="editorToggle">×</button>
        </div>
        <div id="editorContainer">
          <div id="editor" style="height: 100%; width: 100%;"></div>
        </div>
        <div class="resize-handle editor-resize-handle" id="editorResizeHandle"></div>
      </div>

      <div class="preview-panel" id="previewPanel">
        <div class="panel-header">
          Preview
          <button class="outline-toggle" id="previewToggle">×</button>
        </div>
        <div id="preview"></div>
      </div>
    </div>

    <div class="status-bar">
      <span id="fileName">Untitled.md</span>
      <div class="status-right">
        <span id="autoSaveStatus" class="auto-save-status">Auto-save: Ready</span>
        <span id="wordCount">0 words</span>
      </div>
    </div>

    <!-- Custom Theme Modal -->
    <div id="themeModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Create Custom Theme</h2>
          <button class="close-modal">&times;</button>
        </div>

        <div class="color-grid">
          <div class="color-input-group">
            <label>Primary Background</label>
            <div class="color-input-wrapper">
              <input type="color" id="color-bg-primary" value="#1e1e1e" />
              <input type="text" id="text-bg-primary" value="#1e1e1e" />
            </div>
          </div>

          <div class="color-input-group">
            <label>Secondary Background</label>
            <div class="color-input-wrapper">
              <input type="color" id="color-bg-secondary" value="#252526" />
              <input type="text" id="text-bg-secondary" value="#252526" />
            </div>
          </div>

          <div class="color-input-group">
            <label>Tertiary Background</label>
            <div class="color-input-wrapper">
              <input type="color" id="color-bg-tertiary" value="#2d2d30" />
              <input type="text" id="text-bg-tertiary" value="#2d2d30" />
            </div>
          </div>

          <div class="color-input-group">
            <label>Border Color</label>
            <div class="color-input-wrapper">
              <input type="color" id="color-border-color" value="#3e3e42" />
              <input type="text" id="text-border-color" value="#3e3e42" />
            </div>
          </div>

          <div class="color-input-group">
            <label>Primary Text</label>
            <div class="color-input-wrapper">
              <input type="color" id="color-text-primary" value="#d4d4d4" />
              <input type="text" id="text-text-primary" value="#d4d4d4" />
            </div>
          </div>

          <div class="color-input-group">
            <label>Accent Color</label>
            <div class="color-input-wrapper">
              <input type="color" id="color-accent-primary" value="#007acc" />
              <input type="text" id="text-accent-primary" value="#007acc" />
            </div>
          </div>

          <div class="color-input-group">
            <label>Heading Color</label>
            <div class="color-input-wrapper">
              <input type="color" id="color-heading-color" value="#569cd6" />
              <input type="text" id="text-heading-color" value="#569cd6" />
            </div>
          </div>

          <div class="color-input-group">
            <label>Link Color</label>
            <div class="color-input-wrapper">
              <input type="color" id="color-link-color" value="#3794ff" />
              <input type="text" id="text-link-color" value="#3794ff" />
            </div>
          </div>

          <div class="color-input-group">
            <label>Code Background</label>
            <div class="color-input-wrapper">
              <input type="color" id="color-code-bg" value="#2d2d30" />
              <input type="text" id="text-code-bg" value="#2d2d30" />
            </div>
          </div>

          <div class="color-input-group">
            <label>Code Text</label>
            <div class="color-input-wrapper">
              <input type="color" id="color-code-text" value="#ce9178" />
              <input type="text" id="text-code-text" value="#ce9178" />
            </div>
          </div>
        </div>

        <div class="modal-actions">
          <button class="btn-secondary" id="resetTheme">
            Reset to Default
          </button>
          <button class="btn-primary" id="applyTheme">Apply Theme</button>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/11.1.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>
